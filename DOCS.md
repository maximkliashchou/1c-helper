# Документация проекта «Помощник в изучении языка 1С»

## Назначение

Веб-приложение для помощи в изучении языка 1С: теория по темам, задачи с автоматической проверкой кода по тестам, учёт попыток и профиль пользователя.

## Роли

| Роль   | Возможности |
|--------|--------------|
| Гость  | Просмотр тем, поиск, просмотр теории. Доступ к списку задач и к отправке решений — только после входа. |
| USER   | Всё то же + решение задач, отправка кода, просмотр своих попыток, профиль (смена почты, пароля, аватара). |
| ADMIN  | Всё то же + создание/редактирование тем, добавление задач и тестов (не менее 4 тестов на задачу). |

## Сценарии

### Пользователь

1. **Главная** — видит темы, может искать по названию/описанию и переходить в тему.
2. **Тема** — читает материал с примерами кода и картинками; видит кнопку «Перейти к задачам», если задачи есть.
3. **Задачи** — список задач по теме. Если не авторизован — предлагается войти/зарегистрироваться.
4. **Задача** — условие, поле для кода (ввод или загрузка файла), кнопка «Отправить на проверку». Результат: прошло/не прошло и сколько тестов пройдено. Ниже — таблица своих попыток с возможностью открыть код любой попытки.
5. **Профиль** — данные пользователя, все попытки по всем задачам, смена email, пароля, загрузка аватара.

### Администратор

1. **Админ-панель** (ссылка в шапке) — список тем, кнопки «Изменить», «+ Задача», «+ Добавить тему».
2. Создание темы: название, описание, контент (HTML/текст).
3. Создание задачи: выбор темы, название, условие.
4. Тесты к задаче добавляются через API: `POST /api/admin/tasks/{taskId}/tests` с телом `{"input": "...", "expectedOutput": "..."}`. Минимум 4 теста на задачу — иначе отправка решения вернёт ошибку.

## Проверка решений

Код выполняется в среде [OneScript](https://oscript.io). Для каждого теста скрипт запускается, stdout (и при необходимости stderr) сравнивается с ожидаемым выводом. В коде нужно использовать **Сообщить()**. После **успешной сдачи** задачи повторная отправка по ней блокируется (и в интерфейсе, и по API).

## Запуск

Подробно — в [README.md](README.md). Кратко:

- **Docker:** `docker compose up -d --build` → приложение на http://localhost:8080. Сброс БД: `docker compose down -v`, затем `docker compose up -d`.
- **Локально:** PostgreSQL создан и запущен, затем `mvn spring-boot:run` или запуск JAR.

Учётная запись по умолчанию: **admin** / **admin** (роль ADMIN).

## API

Базовый префикс: `/api`. Авторизация: заголовок `Authorization: Bearer <token>` (токен возвращается при логине и регистрации).

Основные группы:

- **Публичные:** `GET /topics`, `GET /topics/search?q=...`, `GET /topics/{id}`, `GET /topics/{topicId}/tasks`, `GET /tasks/{id}`, `POST /auth/register`, `POST /auth/login`.
- **Пользователь:** `GET/PUT /profile/me`, `POST /profile/me/avatar`, `POST /tasks/{taskId}/submit`, `GET /attempts/my`, `GET /attempts/my/task/{taskId}`, `GET /attempts/{id}`.
- **Админ:** `POST/PUT/DELETE /admin/topics`, `POST/PUT/DELETE /admin/tasks`, `POST /admin/tasks/{taskId}/tests`.

Полное описание эндпоинтов и тел запросов — в [README.md](README.md#документация-по-api).
